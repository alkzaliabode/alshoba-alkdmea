<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\MainGoal;
use App\Models\DepartmentGoal;
use App\Models\UnitGoal;

class GoalsSeeder extends Seeder
{
    public function run(): void
    {
        // 1. إنشاء الهدف الرئيسي
        $mainGoal = MainGoal::create([
            'goal_text' => 'تقديم أفضل الخدمات كماً ونوعاً للزائرين الكرام في مدينة الإمام الحسين',
        ]);

        // 2. أهداف الشعبة الخدمية
        $departmentGoalsTexts = [
            'الحفاظ على نظافة جميع مرافق المدينة ومحيطها الخارجي.',
            'ضمان جاهزية وصيانة جميع المرافق الصحية بشكل مستمر.',
            'توفير بيئة نظيفة وصحية وآمنة للزائرين على مدار الساعة.',
            'الاستجابة السريعة للأعطال الطارئة في وحدات الخدمة.',
            'جدولة وتنفيذ خطط التنظيف والصيانة اليومية والأسبوعية.',
            'دعم المناسبات والزيارات المليونية بخطط تنظيف استثنائية.',
            'إدارة ومتابعة أداء فرق العمل وتوزيع المهام بكفاءة.',
            'تحسين الموارد المستخدمة وتقليل الهدر في الاستهلاك.',
            'تعزيز ثقافة النظافة العامة لدى العاملين والزائرين.',
            'إعداد تقارير مهنية يومية وشهرية لرفعها لإدارة المدينة.',
        ];

        $departmentGoalIds = [];

        foreach ($departmentGoalsTexts as $goalText) {
            $departmentGoal = DepartmentGoal::create([
                'main_goal_id' => $mainGoal->id,
                'goal_text' => $goalText,
            ]);

            $departmentGoalIds[] = $departmentGoal->id;
        }

        // نستخدم أول هدف كشائع لجميع الوحدات، أو يمكن تخصيصهم لاحقاً
        $defaultDepartmentGoalId = $departmentGoalIds[0];

        // 3. أهداف الوحدات
        $unitGoals = [
            'وحدة القاعات' => [
                'تنظيف قاعة واحدة يوميًا مع إدامة عميقة للطابقين العلوي والسفلي حسب الخطة الأسبوعية.',
                'إدامة يومية لقاعات المبيت بعد مغادرة الزوار.',
                'التعقيم الكامل للقاعات باستخدام المعقمات المعتمدة وفق جدول دوري.',
            ],
            'الساحات' => [
                'كنس وغسل الساحات العامة ثلاث مرات يوميًا.',
                'إزالة الأوساخ والمخلفات بشكل دوري كل ساعتين.',
            ],
            'فرش السجاد' => [
                'فرش السجاد في القاعات والساحات.',
                'التأكد من نظافة وتعقيم السجاد قبل وبعد الاستخدام.',
            ],
            'خزانات المياه (الترامز)' => [
                'تعبئة الترامز كل 4 ساعات أو حسب الحاجة.',
                'التأكد من نظافتها وصلاحية المياه داخلها.',
            ],
            'رفع الحاويات والنفايات' => [
                'رفع الحاويات من جميع النقاط كل 6 ساعات.',
                'غسل وتعقيم الحاويات كل نهاية يوم.',
            ],
            'وحدة المنشآت الصحية' => [
                'تنظيف وتعقيم الحمامات كل ساعتين.',
                'إعادة تعبئة المواد الصحية (صابون، الزاهي للغسالات) بشكل دوري.',
                'صيانة دورية للسيفونات، المغاسل، والمرايا.',
                'إصلاح الأعطال في وقت قصير من الإبلاغ.',
            ],
        ];

        foreach ($unitGoals as $unitName => $goals) {
            foreach ($goals as $goalText) {
                UnitGoal::create([
                    'department_goal_id' => $defaultDepartmentGoalId, // ✅ الرابط الإجباري
                    'unit_name' => $unitName,
                    'goal_text' => $goalText,
                ]);
            }
        }

        $this->command->info('✅ تم زرع الأهداف بنجاح.');
    }
}
